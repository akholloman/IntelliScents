<!DOCTYPE html>
<html>
<head>
    <script src="/socket.io/socket.io.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <script src="//unpkg.com/brain.js"></script>
  <title>Adaptive Arduino Control</title>
  <meta name="description" content="Control Arduino using Socket-io">
  <meta name="author" content="HTIL">
    <style>
    .button {
      border: none;
      width: 100%;
      color: white;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 32px;
      margin: 4px 2px;
      cursor: pointer;
    }
    
    .button1 {background-color: #da2727;} /* Red */
    .button2 {background-color: #28e522;} /* Green */

    </style>
</head>
 <body>
        <div id="demo" class="center-content page-container">
            <canvas></canvas>
        
          <script>
            console.log("LOADING PAGE . . .")

            //EMERGENCY STOP button flag
            let shouldStop = false;

            //EMERGENCY STOP func
            async function turnMotorOff() {
                shouldStop = true;
                socket.sendServerMsgFromClient4()
                console.log("Motor Stopped");
            }

            //Defining INTERVAL flag
            let motorOn;

            //Fan On Interval
            async function fanOn() {
                console.log("START fan for 10 seconds")
            }

            //Start Fan Timer
            async function startTimer() {
                console.log("Starting Fan Intervals")
                console.log("")
                motorOn = setInterval(fanOn, 10000)
                console.log("10 seconds")
            }

          </script>

      </div>
        <button class="button button2" onclick="startTimer()">Start Study Session</button>
        <button class="button button1" onclick="clearInterval(motorOn); turnMotorOff()">STOP SESSION</button> 
</body>
    
<script>
    var NodeSocket = function() {
       this.socket = io();

       this.sendServerMsgFromClient = function(speed) {
           this.socket.emit("speed", {speed})
       };

       this.sendServerMsgFromClient4 = function() {
           this.socket.emit("stopMotor", {})
       };

       // Create listener
       this.socket.on("exampleServerEvent", function(packet) {
          console.log("Client: ", packet)
       });
   };

   socket = new NodeSocket();

 </script>
 
</html> 

